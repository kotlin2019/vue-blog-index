(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a67591c6"],{7497:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"higtlight"},[s("section",{staticClass:"about-bg"},[s("img",{staticClass:"bg-img",attrs:{src:t.$staticUrl+t.banners[3].url}}),s("div",{staticClass:"bg"}),s("p",{staticClass:"mgs-title"},[t._v("Say Hello~")]),s("div",{staticClass:"input-main"},[s("div",{staticClass:"input-box main"},[s("div",{staticClass:"userbox"},[s("div",{staticClass:"user-img"},[s("img",{attrs:{src:t.user.avatar_url||"https://avatars.dicebear.com/v2/identicon/id-"+t.user.id+".svg"}}),s("h4",[t._v(t._s(t.user.name||"未登录"))])])]),s("div",{staticClass:"textbox"},[s("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},maxlength:400,placeholder:t.textarea},model:{value:t.message.content,callback:function(e){t.$set(t.message,"content",e)},expression:"message.content"}}),s("div",{staticClass:"submit-box"},[s("Button",{attrs:{type:"primary"},on:{click:t.submitMessage}},[s("Icon",{attrs:{type:"ios-create"}}),t._v("\n              提交评论\n            ")],1)],1)],1)])])]),t.loading?s("MyLoading"):s("section",{staticClass:"main"},[t._l(t.messageList,function(e,a){return s("div",{key:a,staticClass:"commentList"},[s("div",{staticClass:"user-ava"},[e.user?s("img",{attrs:{src:e.user.avatar_url||"https://avatars.dicebear.com/v2/identicon/id-"+e.user.id+".svg",onerror:"this.src='https://avatars.dicebear.com/v2/identicon/id-undefined.svg'",alt:"hasLogin"}}):s("img",{attrs:{src:"https://avatars.dicebear.com/v2/identicon/id-undefined.svg",alt:"unLogin"}})]),s("div",{staticClass:"comment-main"},[s("div",{staticClass:"comment-box animate03"},[s("div",{staticClass:"username"},[s("span",[s("Icon",{attrs:{type:"md-person"}}),t._v("\n              "+t._s(e.user?e.user.name:e.name?"游客（"+e.name+"）":"游客")+" \n              "),1==e.user_id?s("em",[t._v("(博主)")]):t._e(),s("span",{staticClass:"created"},[s("Icon",{attrs:{type:"ios-time-outline"}}),t._v(t._s(e.created_at))],1)],1),s("span",{staticClass:"floor"},[t._v(t._s(e.id)+"楼")])]),s("div",{directives:[{name:"highlight",rawName:"v-highlight"}],staticClass:"com_detail",domProps:{innerHTML:t._s(e.content)}}),s("div",{staticClass:"comment-menu"},[s("Poptip",{attrs:{confirm:"",placement:"left",title:"是否删除该留言?"},on:{"on-ok":function(s){return t.deleteComment(e)}}},[e.user_id==t.user.id?s("Icon",{attrs:{type:"md-trash"}}):t._e()],1),s("Tooltip",{attrs:{content:"回复留言"}},[s("i",{staticClass:"iconfont lv-icon-xiaoxi2",on:{click:function(s){return t.handleReply(e,e)}}})])],1),t._l(e.reply,function(a,n){return s("div",{key:n,staticClass:"reply-box"},[s("p",{staticClass:"reply-header"},[s("span",[t._v("\n                "+t._s(a.user.name)+"\n                "),1==a.user.id?s("em",[t._v("(博主)")]):t._e(),s("span",{staticClass:"noml"},[t._v("回复")]),s("span",[t._v(t._s(a.topic_user?a.topic_user.name:"游客"))]),a.topic_user&&1==a.topic_user.id?s("em",[t._v("(博主)")]):t._e(),s("span",{staticClass:"created"},[s("Icon",{attrs:{type:"ios-time-outline"}}),t._v(" "+t._s(e.created_at))],1)])]),s("div",{directives:[{name:"highlight",rawName:"v-highlight"}],staticClass:"com_detail",domProps:{innerHTML:t._s(a.content)}}),s("div",{staticClass:"comment-menu"},[s("Poptip",{attrs:{confirm:"",placement:"left",title:"是否删除该留言?"},on:{"on-ok":function(e){return t.deleteReply(a)}}},[a.user_id==t.user.id?s("Icon",{attrs:{type:"md-trash"}}):t._e()],1),s("Tooltip",{attrs:{content:"回复留言"}},[s("i",{staticClass:"iconfont lv-icon-xiaoxi2",on:{click:function(s){return t.handleReply(e,a)}}})])],1)])})],2),e.id==t.messageId?s("div",{staticClass:"reply-text"},[s("Input",{ref:"textarea",refInFor:!0,attrs:{type:"textarea",autosize:{minRows:3,maxRows:8},maxlength:400,placeholder:t.replyTextarea},model:{value:t.replyContent,callback:function(e){t.replyContent=e},expression:"replyContent"}}),s("div",{staticClass:"reply-button"},[s("Button",{staticClass:"cancel",on:{click:t.cancelReply}},[t._v("\n              取消回复\n            ")]),s("Button",{attrs:{type:"primary"},on:{click:t.submitReply}},[s("Icon",{attrs:{type:"ios-create"}}),t._v("\n              回复留言\n            ")],1)],1)],1):t._e()])])}),t.pageModel.sumCount>10?s("NewPage",{attrs:{pageModel:t.pageModel},on:{selectList:t.selectRoleList}}):t._e()],2)],1)},n=[],i=(s("8e6e"),s("456d"),s("7f7f"),s("ac6a"),s("bd86")),c=s("2f62"),o=s("0e54"),r=s.n(o);s("bc07");function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),s.push.apply(s,a)}return s}function u(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(s,!0).forEach(function(e){Object(i["a"])(t,e,s[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(s).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))})}return t}var p={data:function(){return{textarea:"支持markdown语法，尾部2个空格后回车才会换行，最长400个字",replyTextarea:"",replyContent:"",loading:!0,messageList:[],messageId:-1,topicUserId:"",isReply:!1,message:{content:"",ykname:""},pageModel:{page:1,sumCount:10},page:2,hasMore:!0}},computed:u({},Object(c["c"])(["user","banners"]),{compiledMarkdown:function(){return r()(this.detail.content,{sanitize:!1})}}),created:function(){this.getMessage()},methods:{getMessage:function(){var t=this;this.$post("/apis/message/list",this.pageModel).then(function(e){t.loading=!1,t.pageModel.sumCount=e.data.total,t.messageList=e.data.data,t.messageList.forEach(function(t){t.content=r()(t.content,{sanitize:!1}),t.reply.length>0&&t.reply.forEach(function(t){t.content=r()(t.content,{sanitize:!1})})})}).catch(function(){})},selectRoleList:function(){this.getMessage()},submitMessage:function(){var t=this;this.$post("/apis/message/add",this.message).then(function(e){t.getMessage(),t.$Message.success(e.message),t.message={content:"",name:""}}).catch(function(){})},deleteComment:function(t){var e=this;this.$post("/apis/message/delete",{id:t.id}).then(function(s){e.messageList.splice(e.messageList.indexOf(t),1),e.$Message.success(s.message)}).catch(function(){})},deleteReply:function(t){var e=this;this.$post("/apis/message/reply/delete",{id:t.id}).then(function(t){e.getMessage(),e.$Message.success(t.message)}).catch(function(){})},handleReply:function(t,e){var s=this;t.user?(this.messageId=t.id,this.topicUserId=e.user.id,this.replyTextarea="回复"+e.user.name+"：",this.replyContent="",setTimeout(function(){s.$refs.textarea[0].focus()},200)):this.$Message.error("不能回复游客！")},cancelReply:function(){this.messageId=-1},submitReply:function(){var t=this,e={content:this.replyContent,message_id:this.messageId,topic_user_id:this.topicUserId};this.$post("/apis/message/reply",e).then(function(e){t.getMessage(),t.$Message.success(e.message),t.cancelReply()}).catch(function(){})}}},d=p,m=(s("aa1f"),s("2877")),g=Object(m["a"])(d,a,n,!1,null,"34b9963a",null);e["default"]=g.exports},"7f7f":function(t,e,s){var a=s("86cc").f,n=Function.prototype,i=/^\s*function ([^ (]*)/,c="name";c in n||s("9e1e")&&a(n,c,{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(t){return""}}})},aa1f:function(t,e,s){"use strict";var a=s("e69e"),n=s.n(a);n.a},bc07:function(t,e,s){},e69e:function(t,e,s){}}]);